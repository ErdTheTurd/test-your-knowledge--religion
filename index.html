import React, { useState, useEffect } from 'react';
import { CheckCircle, XCircle, ChevronRight } from 'lucide-react';

const quizData = {
  places: [
    {
      image: "./images/places/synagogue.png",
      correct: "Judaism",
      options: ["Christianity", "Judaism", "Zoroastrianism", "Islam"],
      explanation: "Synagogues are Jewish places of worship, often featuring the Star of David"
    },
    {
      image: "./images/places/buddhist-temple.png",
      correct: "Buddhism",
      options: ["Hinduism", "Taoism", "Buddhism", "Shintoism"],
      explanation: "Buddhist temples feature distinctive pagoda architecture and golden stupas"
    },
    {
      image: "./images/places/kaaba.png",
      correct: "Islam",
      options: ["Judaism", "Islam", "Christianity", "Bah√°'√≠"],
      explanation: "The Kaaba in Mecca is Islam's most sacred site"
    },
    {
      image: "./images/places/church.png",
      correct: "Christianity",
      options: ["Judaism", "Islam", "Christianity", "Buddhism"],
      explanation: "St. Peter's Basilica in Vatican City is the heart of Catholic Christianity"
    },
    {
      image: "./images/places/gurdwara.png",
      correct: "Sikhism",
      options: ["Hinduism", "Sikhism", "Buddhism", "Jainism"],
      explanation: "Gurdwaras are Sikh temples, with the Golden Temple being the most famous"
    },
    {
      image: "./images/places/hindu-temple.png",
      correct: "Hinduism",
      options: ["Buddhism", "Hinduism", "Jainism", "Sikhism"],
      explanation: "Hindu temples are known for their intricate carvings and colorful gopurams"
    },
    {
      image: "./images/places/western-wall.png",
      correct: "Judaism",
      options: ["Christianity", "Judaism", "Islam", "Druze"],
      explanation: "The Western Wall in Jerusalem is one of Judaism's holiest sites"
    },
    {
      image: "./images/places/shinto-shrine.png",
      correct: "Shintoism",
      options: ["Buddhism", "Shintoism", "Taoism", "Confucianism"],
      explanation: "Shinto shrines in Japan feature distinctive torii gates"
    },
    {
      image: "./images/places/mosque.png",
      correct: "Islam",
      options: ["Christianity", "Islam", "Hinduism", "Buddhism"],
      explanation: "The Blue Mosque in Istanbul is one of Islam's most iconic places of worship"
    },
    {
      image: "./images/places/angkor-wat.png",
      correct: "Hinduism",
      options: ["Buddhism", "Hinduism", "Jainism", "Sikhism"],
      explanation: "Angkor Wat was originally built as a Hindu temple, though later used by Buddhists"
    }
  ],
  people: [
    {
      image: "./images/people/sikh-turban.png",
      correct: "Sikhism",
      options: ["Islam", "Sikhism", "Hinduism", "Jainism"],
      explanation: "Sikhs wear turbans as a religious requirement and symbol of faith"
    },
    {
      image: "./images/people/pope.png",
      correct: "Christianity",
      options: ["Judaism", "Christianity", "Zoroastrianism", "Islam"],
      explanation: "The Pope is the leader of the Catholic Church"
    },
    {
      image: "./images/people/buddhist-monk.png",
      correct: "Buddhism",
      options: ["Hinduism", "Buddhism", "Taoism", "Confucianism"],
      explanation: "Buddhist monks wear distinctive orange or maroon robes"
    },
    {
      image: "./images/people/imam.png",
      correct: "Islam",
      options: ["Judaism", "Islam", "Christianity", "Bah√°'√≠"],
      explanation: "Imams are Islamic religious leaders who lead prayers"
    },
    {
      image: "./images/people/orthodox-jew.png",
      correct: "Judaism",
      options: ["Christianity", "Judaism", "Islam", "Druze"],
      explanation: "Orthodox Jewish men often wear yarmulkes and traditional black clothing"
    },
    {
      image: "./images/people/sadhu.png",
      correct: "Hinduism",
      options: ["Buddhism", "Hinduism", "Jainism", "Sikhism"],
      explanation: "Sadhus are Hindu holy men who have renounced worldly life"
    },
    {
      image: "./images/people/christian-clergy.png",
      correct: "Christianity",
      options: ["Judaism", "Christianity", "Islam", "Zoroastrianism"],
      explanation: "Christian clergy often wear crosses and religious vestments"
    },
    {
      image: "./images/people/tibetan-monk.png",
      correct: "Buddhism",
      options: ["Hinduism", "Buddhism", "Bon", "Taoism"],
      explanation: "Tibetan Buddhist monks wear distinctive maroon and yellow robes"
    },
    {
      image: "./images/people/muslim-person.png",
      correct: "Islam",
      options: ["Christianity", "Islam", "Judaism", "Sikhism"],
      explanation: "Many Muslims wear traditional Islamic dress including hijab and prayer caps"
    },
    {
      image: "./images/people/hindu-person.png",
      correct: "Hinduism",
      options: ["Buddhism", "Hinduism", "Jainism", "Sikhism"],
      explanation: "Hindu religious attire often includes tilaka marks and traditional garments"
    }
  ],
  culture: [
    {
      image: "./images/culture/hanukkah.png",
      correct: "Judaism",
      options: ["Christianity", "Judaism", "Islam", "Zoroastrianism"],
      explanation: "Hanukkah is the Jewish Festival of Lights"
    },
    {
      image: "./images/culture/vesak.png",
      correct: "Buddhism",
      options: ["Hinduism", "Buddhism", "Jainism", "Taoism"],
      explanation: "Vesak celebrates the birth, enlightenment, and death of Buddha"
    },
    {
      image: "./images/culture/christmas.png",
      correct: "Christianity",
      options: ["Judaism", "Christianity", "Islam", "Zoroastrianism"],
      explanation: "Christmas celebrates the birth of Jesus Christ"
    },
    {
      image: "./images/culture/holi.png",
      correct: "Hinduism",
      options: ["Buddhism", "Hinduism", "Jainism", "Sikhism"],
      explanation: "Holi is the Hindu festival of colors celebrating spring"
    },
    {
      image: "./images/culture/eid.png",
      correct: "Islam",
      options: ["Judaism", "Islam", "Christianity", "Bah√°'√≠"],
      explanation: "Eid al-Fitr marks the end of Ramadan fasting"
    },
    {
      image: "./images/culture/vaisakhi.png",
      correct: "Sikhism",
      options: ["Hinduism", "Sikhism", "Jainism", "Buddhism"],
      explanation: "Vaisakhi celebrates the Sikh New Year and founding of the Khalsa"
    },
    {
      image: "./images/culture/buddhist-meditation.png",
      correct: "Buddhism",
      options: ["Hinduism", "Buddhism", "Shintoism", "Taoism"],
      explanation: "Meditation and mindfulness practices are central to Buddhist culture"
    },
    {
      image: "./images/culture/diwali.png",
      correct: "Hinduism",
      options: ["Buddhism", "Hinduism", "Jainism", "Sikhism"],
      explanation: "Diwali, the Festival of Lights, is a major Hindu celebration"
    },
    {
      image: "./images/culture/ramadan.png",
      correct: "Islam",
      options: ["Christianity", "Islam", "Judaism", "Bah√°'√≠"],
      explanation: "Ramadan is the Islamic holy month of fasting"
    },
    {
      image: "./images/culture/easter.png",
      correct: "Christianity",
      options: ["Judaism", "Christianity", "Islam", "Zoroastrianism"],
      explanation: "Easter celebrates the resurrection of Jesus Christ"
    }
  ],
  cuisine: [
    {
      image: "./images/cuisine/langar.png",
      correct: "Sikhism",
      options: ["Hinduism", "Sikhism", "Jainism", "Buddhism"],
      explanation: "Langar is the free community meal served in Sikh gurdwaras"
    },
    {
      image: "./images/cuisine/iftar.png",
      correct: "Islam",
      options: ["Judaism", "Islam", "Christianity", "Bah√°'√≠"],
      explanation: "Iftar is the evening meal breaking the daily Ramadan fast"
    },
    {
      image: "./images/cuisine/kosher-food.png",
      correct: "Judaism",
      options: ["Islam", "Judaism", "Christianity", "Zoroastrianism"],
      explanation: "Kosher food follows Jewish dietary laws from the Torah"
    },
    {
      image: "./images/cuisine/buddhist-cuisine.png",
      correct: "Buddhism",
      options: ["Hinduism", "Buddhism", "Taoism", "Confucianism"],
      explanation: "Buddhist vegetarian cuisine avoids meat in accordance with non-violence principles"
    },
    {
      image: "./images/cuisine/prasad.png",
      correct: "Hinduism",
      options: ["Buddhism", "Hinduism", "Jainism", "Sikhism"],
      explanation: "Prasad is blessed food offered to Hindu deities and then shared"
    },
    {
      image: "./images/cuisine/communion-bread.png",
      correct: "Christianity",
      options: ["Judaism", "Christianity", "Islam", "Zoroastrianism"],
      explanation: "Communion bread and wine represent the body and blood of Christ"
    },
    {
      image: "./images/cuisine/jain-food.png",
      correct: "Jainism",
      options: ["Hinduism", "Jainism", "Buddhism", "Sikhism"],
      explanation: "Jain cuisine avoids root vegetables to prevent harm to organisms"
    },
    {
      image: "./images/cuisine/challah-bread.png",
      correct: "Judaism",
      options: ["Christianity", "Judaism", "Islam", "Hinduism"],
      explanation: "Challah bread is traditional in Jewish Shabbat meals"
    },
    {
      image: "./images/cuisine/hindu-vegetarian.png",
      correct: "Hinduism",
      options: ["Buddhism", "Hinduism", "Jainism", "Sikhism"],
      explanation: "Many Hindus practice vegetarianism as part of religious observance"
    },
    {
      image: "./images/cuisine/halal-food.png",
      correct: "Islam",
      options: ["Judaism", "Islam", "Christianity", "Buddhism"],
      explanation: "Halal food preparation follows Islamic dietary laws"
    }
  ]
};

export default function ReligionQuiz() {
  const [category, setCategory] = useState(null);
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [score, setScore] = useState(0);
  const [selected, setSelected] = useState(null);
  const [showResult, setShowResult] = useState(false);
  const [gameComplete, setGameComplete] = useState(false);
  const [questions, setQuestions] = useState([]);
  const [shuffledOptions, setShuffledOptions] = useState([]);

  useEffect(() => {
    if (category) {
      const shuffledQuestions = [...quizData[category]].sort(() => Math.random() - 0.5);
      setQuestions(shuffledQuestions);
      setCurrentQuestion(0);
      setScore(0);
      setShowResult(false);
      setGameComplete(false);
    }
  }, [category]);

  useEffect(() => {
    if (questions.length > 0 && questions[currentQuestion]) {
      const shuffled = [...questions[currentQuestion].options].sort(() => Math.random() - 0.5);
      setShuffledOptions(shuffled);
    }
  }, [currentQuestion, questions]);

  const handleAnswer = (answer) => {
    if (showResult) return;
    
    setSelected(answer);
    setShowResult(true);
    
    if (answer === questions[currentQuestion].correct) {
      setScore(score + 1);
    }
  };

  const handleNext = () => {
    if (currentQuestion < questions.length - 1) {
      setCurrentQuestion(currentQuestion + 1);
      setSelected(null);
      setShowResult(false);
    } else {
      setGameComplete(true);
    }
  };

  const resetGame = () => {
    setCategory(null);
    setCurrentQuestion(0);
    setScore(0);
    setSelected(null);
    setShowResult(false);
    setGameComplete(false);
    setShuffledOptions([]);
  };

  if (!category) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 flex items-center justify-center p-4">
        <div className="max-w-4xl w-full">
          <div className="text-center mb-12 animate-fade-in">
            <h1 className="text-5xl font-bold text-gray-800 mb-3">Religion Quiz</h1>
            <p className="text-xl text-gray-600">Test your knowledge of world religions</p>
          </div>
          
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            {[
              { key: 'places', title: 'Places', emoji: 'üïå', gradient: 'from-blue-500 to-blue-600' },
              { key: 'people', title: 'People', emoji: 'üë•', gradient: 'from-purple-500 to-purple-600' },
              { key: 'culture', title: 'Culture', emoji: 'üé≠', gradient: 'from-pink-500 to-pink-600' },
              { key: 'cuisine', title: 'Cuisine', emoji: 'üçΩÔ∏è', gradient: 'from-orange-500 to-orange-600' }
            ].map((cat) => (
              <button
                key={cat.key}
                onClick={() => setCategory(cat.key)}
                className={`bg-gradient-to-r ${cat.gradient} text-white rounded-2xl p-8 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300`}
              >
                <div className="text-6xl mb-4">{cat.emoji}</div>
                <div className="text-2xl font-bold">{cat.title}</div>
              </button>
            ))}
          </div>
        </div>
      </div>
    );
  }

  if (gameComplete) {
    const percentage = Math.round((score / questions.length) * 100);
    
    const messages = [
      "You knew the junk from the gunk!",
      "You're a religion scholar!",
      "Holy smokes, great job!",
      "You've got divine knowledge!",
      "Absolutely enlightened performance!",
      "You separated the sacred from the mundane!",
      "Blessed with knowledge!",
      "Your wisdom is spiritual!",
      "You've achieved quiz nirvana!",
      "Faith in your abilities: confirmed!",
      "You're on a higher plane of understanding!",
      "Prophetic performance!",
      "You've got that holy insight!",
      "Miraculous results!",
      "You distinguished the divine!"
    ];
    
    const randomMessage = messages[Math.floor(Math.random() * messages.length)];
    
    return (
      <div className="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 flex items-center justify-center p-4">
        <div className="max-w-md w-full bg-white rounded-3xl shadow-2xl p-8 text-center">
          <div className="text-6xl mb-6">
            {percentage >= 75 ? 'üéâ' : percentage >= 50 ? 'üëç' : 'üìö'}
          </div>
          <h2 className="text-3xl font-bold text-gray-800 mb-4">Quiz Complete!</h2>
          <p className="text-xl text-indigo-600 font-semibold mb-4">{randomMessage}</p>
          <div className="text-6xl font-bold text-indigo-600 mb-2">{score}/{questions.length}</div>
          <p className="text-xl text-gray-600 mb-8">{percentage}% correct</p>
          <button
            onClick={resetGame}
            className="w-full bg-gradient-to-r from-indigo-500 to-purple-600 text-white py-4 rounded-xl font-semibold text-lg hover:shadow-lg transform hover:scale-105 transition-all duration-300"
          >
            Try Another Category
          </button>
        </div>
      </div>
    );
  }

  const current = questions[currentQuestion];
  
  if (!current || shuffledOptions.length === 0) {
    return <div className="min-h-screen flex items-center justify-center">Loading...</div>;
  }
  
  const isCorrect = selected === current.correct;

  return (
    <div className="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 p-4 py-8">
      <div className="max-w-2xl mx-auto">
        {/* Header */}
        <div className="flex items-center justify-between mb-8">
          <button
            onClick={resetGame}
            className="text-gray-600 hover:text-gray-800 font-medium"
          >
            ‚Üê Back
          </button>
          <div className="text-center">
            <div className="text-sm text-gray-600 mb-1">Question {currentQuestion + 1} of {questions.length}</div>
            <div className="w-48 h-3 bg-gray-200 rounded-full overflow-hidden">
              <div 
                className="h-full bg-gradient-to-r from-indigo-500 to-purple-600 transition-all duration-500"
                style={{ width: `${((currentQuestion + 1) / questions.length) * 100}%` }}
              />
            </div>
          </div>
          <div className="text-gray-600 font-semibold">Score: {score}</div>
        </div>

        {/* Image */}
        <div className="bg-white rounded-3xl shadow-xl overflow-hidden mb-6">
          <img 
            src={current.image} 
            alt="Quiz question"
            className="w-full h-80 object-cover"
          />
        </div>

        {/* Question */}
        <h2 className="text-2xl font-bold text-gray-800 mb-6 text-center">
          Which religion is this associated with?
        </h2>

        {/* Options */}
        <div className="space-y-3 mb-6">
          {shuffledOptions.map((option) => {
            const isSelected = selected === option;
            const isCorrectOption = option === current.correct;
            
            let buttonClass = "w-full p-4 rounded-xl font-semibold text-lg transition-all duration-300 ";
            
            if (!showResult) {
              buttonClass += "bg-white hover:bg-indigo-50 border-2 border-gray-200 hover:border-indigo-400 text-gray-800";
            } else if (isCorrectOption) {
              buttonClass += "bg-green-500 text-white border-2 border-green-600";
            } else if (isSelected && !isCorrect) {
              buttonClass += "bg-red-500 text-white border-2 border-red-600";
            } else {
              buttonClass += "bg-gray-100 text-gray-500 border-2 border-gray-200";
            }

            return (
              <button
                key={option}
                onClick={() => handleAnswer(option)}
                disabled={showResult}
                className={buttonClass}
              >
                <div className="flex items-center justify-between">
                  <span>{option}</span>
                  {showResult && isCorrectOption && <CheckCircle className="w-6 h-6" />}
                  {showResult && isSelected && !isCorrect && <XCircle className="w-6 h-6" />}
                </div>
              </button>
            );
          })}
        </div>

        {/* Explanation */}
        {showResult && (
          <div className={`p-6 rounded-xl mb-6 ${isCorrect ? 'bg-green-50 border-2 border-green-200' : 'bg-red-50 border-2 border-red-200'}`}>
            <div className="flex items-start gap-3">
              {isCorrect ? (
                <CheckCircle className="w-6 h-6 text-green-600 flex-shrink-0 mt-1" />
              ) : (
                <XCircle className="w-6 h-6 text-red-600 flex-shrink-0 mt-1" />
              )}
              <div>
                <div className={`font-bold text-lg mb-2 ${isCorrect ? 'text-green-800' : 'text-red-800'}`}>
                  {isCorrect ? 'Correct!' : 'Not quite!'}
                </div>
                <p className="text-gray-700">{current.explanation}</p>
              </div>
            </div>
          </div>
        )}

        {/* Next Button */}
        {showResult && (
          <button
            onClick={handleNext}
            className="w-full bg-gradient-to-r from-indigo-500 to-purple-600 text-white py-4 rounded-xl font-semibold text-lg hover:shadow-lg transform hover:scale-105 transition-all duration-300 flex items-center justify-center gap-2"
          >
            {currentQuestion < questions.length - 1 ? 'Next Question' : 'See Results'}
            <ChevronRight className="w-5 h-5" />
          </button>
        )}
      </div>
    </div>
  );
}
